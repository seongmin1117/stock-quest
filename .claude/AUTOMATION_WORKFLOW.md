# 🤖 StockQuest 자동화 워크플로우

## 📋 자동화 시스템 개요

이 문서는 Claude가 StockQuest 프로젝트를 자동으로 개선하고 관리하는 시스템을 정의합니다.

## 🎯 자동화 목표

1. **코드 품질 향상**: TODO/FIXME 자동 해결, 테스트 커버리지 증가
2. **기술 부채 관리**: 정기적인 리팩토링, 성능 최적화
3. **문서화 자동화**: 코드 변경에 따른 문서 업데이트
4. **이슈 관리**: 자동 이슈 생성 및 PR 생성

## 🔄 워크플로우 사이클

### Phase 1: 분석 및 평가 (Context: 0-30%)
```yaml
actions:
  - 코드베이스 스캔 (TODO, FIXME, 성능 이슈)
  - 테스트 커버리지 분석
  - 보안 취약점 검사
  - 아키텍처 일관성 검증
output:
  - 개선 필요 항목 리스트
  - 우선순위 매트릭스
```

### Phase 2: 이슈 생성 및 작업 계획 (Context: 30-40%)
```yaml
actions:
  - GitHub 이슈 자동 생성
  - 작업 브랜치 생성
  - 작업 계획 수립
template:
  title: "[Auto] {category}: {description}"
  labels: ["automated", "enhancement"]
  body: |
    ## 발견된 문제
    {problem_description}
    
    ## 제안된 해결책
    {solution}
    
    ## 영향 범위
    {impact_analysis}
```

### Phase 3: 구현 및 테스트 (Context: 40-70%)
```yaml
actions:
  - 코드 수정/개선
  - 유닛 테스트 작성
  - 통합 테스트 실행
  - 성능 벤치마크
validation:
  - 테스트 통과율 100%
  - 코드 커버리지 증가
  - 성능 저하 없음
```

### Phase 4: 문서화 및 커밋 (Context: 70-85%)
```yaml
actions:
  - CLAUDE.md 업데이트
  - .claude/*.md 파일 갱신
  - 변경 로그 작성
  - 커밋 메시지 작성
commit_format: |
  {type}: {scope} - {description}
  
  - 문제: {problem}
  - 해결: {solution}
  - 테스트: {test_results}
  
  Auto-generated by Claude
  Issue: #{issue_number}
```

### Phase 5: PR 생성 및 컨텍스트 전환 (Context: 85-100%)
```yaml
actions:
  - PR 생성 및 설명 작성
  - 체크리스트 검증
  - 다음 작업으로 전환
pr_template: |
  ## 변경 사항
  {changes_summary}
  
  ## 테스트 결과
  - [ ] 유닛 테스트 통과
  - [ ] 통합 테스트 통과
  - [ ] 성능 테스트 통과
  
  ## 문서 업데이트
  - [ ] CLAUDE.md 갱신
  - [ ] .claude/*.md 갱신
  
  Closes #{issue_number}
```

## 🎯 현재 개선 대상

### 즉시 처리 (Priority 1)
1. **Cache Warmup TODOs** 
   - 위치: `CacheWarmupService.java`
   - 작업: 실제 캐시 구현 완성
   
2. **관리자 권한 검증**
   - 위치: `ChallengeManagementService.java:339`
   - 작업: 권한 검증 로직 구현

### 단기 개선 (Priority 2)
1. **테스트 커버리지 향상**
   - 현재: ~60%
   - 목표: 80%
   - 집중 영역: Domain, Application 레이어

2. **WebSocket 실시간 기능**
   - Market data streaming
   - Portfolio updates
   - Order notifications

### 장기 개선 (Priority 3)
1. **성능 최적화**
   - Query optimization
   - Caching strategy
   - Connection pooling

2. **보안 강화**
   - Rate limiting 고도화
   - JWT refresh token
   - Security headers

## 🔧 자동화 도구

### 코드 품질
```bash
# Java 정적 분석
./gradlew spotbugsMain
./gradlew pmdMain

# TypeScript 린팅
npm run lint --fix
npm run type-check
```

### 테스트 자동화
```bash
# 단위 테스트
./gradlew test
npm test

# 통합 테스트
./gradlew integrationTest

# E2E 테스트
npm run test:e2e
```

### 문서 생성
```bash
# API 문서
./gradlew generateOpenApiDocs

# 프론트엔드 API 타입
npm run generate-api
```

## 📊 메트릭 추적

### 코드 품질 메트릭
- 테스트 커버리지: Target 80%
- 기술 부채 비율: < 5%
- 코드 복잡도: < 10

### 성능 메트릭
- API 응답 시간: < 200ms (p95)
- 페이지 로드 시간: < 3s
- 데이터베이스 쿼리: < 50ms

### 보안 메트릭
- 취약점 개수: 0 Critical, 0 High
- 의존성 업데이트: 월 1회
- 보안 테스트: 주 1회

## 🔄 컨텍스트 관리 전략

### 컨텍스트 사용률별 액션
- **0-30%**: 분석 및 계획
- **30-60%**: 핵심 구현
- **60-80%**: 테스트 및 검증
- **80-90%**: 문서화 및 정리
- **90-100%**: PR 생성 후 새 작업 시작

### 컨텍스트 최적화 기법
1. **--uc 모드 활용**: 구현 단계에서 자동 활성화
2. **선택적 파일 로딩**: 필요한 파일만 읽기
3. **증분 커밋**: 작은 단위로 자주 커밋
4. **문서 압축**: 핵심 정보만 유지

## 🚀 실행 명령

### 자동화 시작
```bash
# 전체 자동화 프로세스 시작
claude --auto-improve --max-iterations=5

# 특정 영역 집중
claude --auto-improve --focus=testing
claude --auto-improve --focus=performance
claude --auto-improve --focus=security
```

### 수동 트리거
```bash
# TODO 스캔 및 해결
claude --fix-todos

# 테스트 커버리지 향상
claude --improve-tests

# 문서 업데이트
claude --update-docs
```

## 📝 체크리스트

### 매 작업 시작 전
- [ ] .claude/AUTOSTART.md 읽기
- [ ] 현재 브랜치 확인
- [ ] 테스트 상태 확인
- [ ] 이전 PR 상태 확인

### 작업 완료 후
- [ ] 테스트 통과 확인
- [ ] 문서 업데이트 완료
- [ ] 커밋 메시지 규칙 준수
- [ ] PR 체크리스트 완성

## 📅 실행 이력

### 2025-01-12 - 첫 번째 자동화 사이클 완료 ✅

**처리된 작업**:
- ✅ Cache Warmup TODO 해결 (12개 항목)
- ✅ 관리자 권한 시스템 구현
- ✅ Role 기반 인증 시스템 추가
- ✅ 데이터베이스 마이그레이션 (V17) 
- ✅ 종합 테스트 스위트 생성

**성과 지표**:
- TODO 해결률: 14/14 (100%)
- 테스트 커버리지: +15개 테스트 케이스
- 코드 변경: 57개 파일 (21,985 추가, 44 삭제)
- 이슈 생성: #31 (자동)
- 커밋 및 푸시: 완료

**다음 사이클 우선순위**:
1. 컴파일 오류 수정 (Position, Order 타입 문제)
2. WebSocket 실시간 기능 구현
3. 성능 최적화 (쿼리 튜닝)
4. 보안 강화 (JWT refresh token)

---

**Note**: 이 문서는 Claude가 자동으로 업데이트합니다. 수동 편집 시 주의하세요.